steps:
 - name: 'gcr.io/cloud-builders/docker'
   id: Build-Deployer
   args:
   - 'build'
   - '-t'
   - 'gcr.io/jfrog-partnership-team/jfrog-artifactory/deployer:7.19'
   - '.' 
 - name: 'gcr.io/cloud-builders/gcloud'
   entrypoint: "bash"
   args: 
     - "-c"
     - |
         #gcloud config set project jfrog-partnership-team
         #gcloud config set compute/zone asia-southeast1-a
         #gcloud config list
         #gcloud container clusters create anup-cluster --machine-type=f1-micro --preemptible --zone=asia-southeast1-a
         #kubectl get nodes
         ls 
 - name: 'gcr.io/cloud-builders/docker'
   id: BuildRT
   args:
   - 'build'
   - '-t'
   - 'gcr.io/jfrog-partnership-team/jfrog-artifactory:7.19.4'
   - '-f'
   - 'jfrog-artifactory/Dockerfile.artifactory'
   - '.' 

 - name: 'gcr.io/cloud-builders/docker'
   id: BuildNG
   args:
   - 'build'
   - '-t'
   - 'gcr.io/jfrog-partnership-team/jfrog-artifactory/nginx-artifactory-pro:7.19.4'
   - '-f'
   - 'jfrog-artifactory/Dockerfile.nginx'
   - '.' 
   
 - name: 'gcr.io/cloud-builders/docker'
   id: Build_xray-analysis_image
   args:
   - 'build'
   - '-t'
   - 'gcr.io/jfrog-partnership-team/jfrog-artifactory/xray-analysis:3.25.1'
   - '-f'
   - 'jfrog-xray/Dockerfile.xray-analysis'
   - '.' 
 - name: gcr.io/cloud-builders/kubectl
   id: Configure kubectl
   args:
     - cluster-info
   env:
     - CLOUDSDK_COMPUTE_REGION=us-central1-b
     - CLOUDSDK_CONTAINER_CLUSTER=anup-cloudbuild
     - KUBECONFIG=/workspace/.kube/config
 - name: gcr.io/$PROJECT_ID/helm
   id: Deploy chart
   args:
     - repo
     - add
     - bitnami
     - https://charts.bitnami.com/bitnami
   env:
     - KUBECONFIG=/workspace/.kube/config

